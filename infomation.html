<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Infomation</title>
	<link href="bootstraps/bootstrap.css" rel="stylesheet">
	<link rel="stylesheet" href="bootstraps/include.css" type="text/css" />
	<script src="jquery/jquery-3.1.1.min.js"></script>
	<script src="jquery/bootstrap.min.js"></script>
	<script src="jquery/jquery-latest.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	
	<script src="p5js/p5.js" type="text/javascript"></script>
    <script src="p5js/p5.dom.js" type="text/javascript"></script>
    <script src="p5js/p5.sound.js" type="text/javascript"></script>
    <script src="menu_top.js" type="text/javascript"></script>
    
    
	<style type="text/css">
		body {
			background: url('image/bg_infomation1.jpg') no-repeat fixed;
			background-size: cover;
		}
		.info-header {
			color:#000fff;
			border-bottom: 2px solid #000fff;
		}
		.margin{
			margin: 40px;
		}
		#content{
			margin: 20px;
		}
		.info{
			font-weight: bold;
			vertical-align: bottom;
		}
		.left{
			text-align: right;
		}
		.info, .left{
			font-size: 1.2em;
		}
		.not_empty{
			color: #ff0000;
		}
		#footer{
			border-top: 4px solid rgba(255, 120, 70, 0.3);
			background-color: rgba(255, 149, 98, 0.4);
		}
		a{
			text-decoration: none;
			color: #000000;
		}
		p{
			margin: 10px;
			padding: 2px;
		}
		#ctent{
			margin: 10px;
			padding: 5px;
		}
		#lichsu, #thegame, #thedt{
			border: 2px solid #000fff;
			border-radius: 0 0 10px 10px;
		}
		.user{
			margin-top: 80px;
		}
		.collapse{
			display: none;
		}
		#change-info{

		}
		#change-password{

		}
		#content{
			margin-left: 50px;
		}
	</style>
</head>
<body>
	<?php
		include "include/header.html";
	?>
	<div class="row" id="content">
		<div class="col-lg-7 col-md-7 col-sm-10 col-xs-12 margin">
			<div class="info-header"><h1>Infomation</h1></div>
			<div class="row" id="content">
				<?php
					if($row_user){
				?>
				<form class="form-horizontal" action="<?php echo $_SERVER['PHP_SELF'];?>">
					
					<div class="form-group">
						<label class="col-lg-6 col-md-6 col-sm-6 col-xs-6 left">Fullname</label>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
							<span class="info" id="name"><?php echo $row_user["fullName"] ?></span>
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-6 col-md-6 col-sm-6 col-xs-6 left">Username</label>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
							<span class="info" id="loginname"><?php echo $row_user["userName"] ?></span>
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-6 col-md-6 col-sm-6 col-xs-6 left">Email</label>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
							<span class="info" id="mail"><?php echo $row_user["email"] ?></span>
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-6 col-md-6 col-sm-6 col-xs-6 left">Sex</label>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
							<span class="info" id="sex"><?php echo $row_user["sex"] ?></span>
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-6 col-md-6 col-sm-6 col-xs-6 left">Birthday</label>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
							<span class="info" id="bday"><span id="datecur">04</span> - <span id="monthcur">03</span> - <span id="yearcur">1995</span></span>
						</div>
					</div>
					<br>
					<div class="form-group">
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 left">
							<button type="button" class="btn btn-primary" data-target="#change-info" onclick="UpdateInfo()">Thay đổi thông tin</button>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
							<button type="button" class="btn btn-primary" data-target="#change-password" onclick="UpdatePass()">Thay đổi mật khẩu</button>
						</div>
					</div>

					<div class="form-group">
						<div id="change-password" class="col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 col-lg-10 col-md-10 col-sm-10 col-xs-10 collapse" style="margin-top: 10px">
							<div class="form-group">
								<label for="new-pwd" class="col-sm-6 left control-label">Mật khẩu mới</label>
								<div class="col-sm-6">
									<input type="password" class="form-control" id="new-pwd" placeholder="">
								</div>
							</div>
							<div class="form-group">
								<label for="re-pwd" class="col-sm-6 left control-label">Nhập lại mật khẩu mới</label>
								<div class="col-sm-6">
									<input type="password" class="form-control" id="re-pwd" placeholder="">
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-6 left">
									<button type="submit" class="btn btn-secondary" onclick="Change_pass()">Cập nhật</button>
								</div>
								<div class="col-sm-6">
									<button type="reset" class="btn btn-secondary">Hủy</button>
								</div>
							</div>
						</div>
						<script type="text/javascript">
							function Change_pass(){
								var new_pass = document.getElementById("new-pwd").value;
								var re_pass = document.getElementById("re-pwd").value;
								var reg_pwd = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?&])[A-Za-z\d$@$!%*#?&]{6,}$/;

								if(new_pass == ""){
									alert("Vui lòng nhập ô Mật khẩu mới!");
								}
								else if(re_pass == ""){
									alert("Vui lòng nhập ô Nhập lại mật khẩu mới!");
								}
								else if(reg_pwd.test(new_pass)==false){
									alert("Mật khẩu cần dài ít nhất 6 kí tự, có chữ cái, chữ số, ký tự đặc biệt");
								}
								else if(re_pass != new_pass){
									alert("Mật khẩu không khớp, vui lòng nhập lại");
								}
								else{
									if(confirm("Bạn thật sự muốn thay đổi mật khẩu?") == true){
										alert("Thay đổi thành công!");
										return true;
									}
									else return false;
								}
								return false;
							}
						</script>
					</div>

					<div class="form-group">
						<div id="change-info" class="col-lg-offset-1 col-md-offset-1 col-sm-offset-1 col-xs-offset-1 col-lg-10 col-md-10 col-sm-10 col-xs-10 collapse" style="margin-top: 10px">
							<form>
								<div class="form-group">
									<label for="hoten" class="col-sm-6 left
									control-label">Họ và Tên</label>
									<div class="col-sm-6">
										<input type="text" class="form-control" id="hoten" placeholder="">

									</div>
								</div>

								<div class="form-group">
									<label for="tendangnhap" class="col-sm-6 left control-label">Tên đăng nhập</label>
									<div class="col-sm-6">
										<input type="text" class="form-control" id="tendangnhap" placeholder="">
									</div>
								</div>

								<div class="form-group">
									<label for="email" class="col-sm-6 left control-label">Email</label>
									<div class="col-sm-6">
										<input type="email" class="form-control" id="email" placeholder="">
									</div>
								</div>

								<div class="form-group">
									<label for="gioitinh" class="col-sm-6 left control-label">Giới tính</label>
									<div class="col-sm-6">
										<label class="radio-inline">
											<input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1"> Nam
										</label>
										<label class="radio-inline">
											<input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2"> Nữ
										</label>
									</div>
								</div>

								<div class="form-group">
									<label for="birthday" class="col-sm-6 control-label">Ngày sinh</label>
									<div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
										<select name="year" id="year" size="1" style="width: 80px"></select>
									</div>   
									<div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">

										<select name="month" id="month" size="1" style="width: 80px"></select>
									</div>
									<div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
										<select name="day" id="day" size="1" style="width: 80px"></select>
									</div>
								</div>
								<br>
								<div class="form-group">
									<div class="col-sm-6 left">
										<button type="submit" class="btn btn-secondary" onclick="Change_info()">Cập nhật</button>
									</div>
									<div class="col-sm-6">
										<button type="reset" class="btn btn-secondary">Hủy</button>
									</div>
								</div>
							</form>
						</div>
						<script type="text/javascript">

							document.getElementById("hoten").value = document.getElementById("name").innerHTML;
							document.getElementById("tendangnhap").value = document.getElementById("loginname").innerHTML;
							document.getElementById("email").value = document.getElementById("mail").innerHTML;
							var gt = document.getElementById("name").innerHTML;
							if(gt == "Nam"){
								document.getElementById("inlineRadio1").checked = true;
							}
							else{
								document.getElementById("inlineRadio2").checked =true;
							}

							var datecur = document.getElementById("datecur").innerHTML;
							var monthcur = document.getElementById("monthcur").innerHTML;
							var yearcur = document.getElementById("yearcur").innerHTML;

							var seYear = $('#year');
							var date = new Date();
							var cur = date.getFullYear();

							seYear.append('<option value="">- Năm -</option>');
							for (var i = cur; i >= 1920; i--) {
								if(i == yearcur){
									seYear.append('<option value="' + i +'" selected>Năm '+i+'</option>');
									continue;
								}
								seYear.append('<option value="'+i+'">Năm '+i+'</option>');
							};
							var seMonth = $('#month');
							var date = new Date();

							var month=new Array();
							for(var i = 0; i<12 ; i++){
								month[i] = "Tháng " + (i+1);
							}

							seMonth.append('<option value="">-Tháng-</option>');
							for (var i = 0; i < 12; i++) {
								if(i+1 == monthcur){
									seMonth.append('<option value="' + i +'" selected>'+month[i]+'</option>');
									continue;
								}
								seMonth.append('<option value="'+i+'">'+month[i]+'</option>');
							};

							function dayList(month,year) {
								var day = new Date(year, month, 0);
								return day.getDate();
							}

							$('#year, #month').change(function(){
								var y = document.getElementById('year');
								var m = document.getElementById('month');
								var d = document.getElementById('day');

								var year = y.options[y.selectedIndex].value;
								var month = m.options[m.selectedIndex+1].value;
								for(var i=days; i>=0;i--){
									d.remove(i);
								}

								var days = (year == ' ' || month == ' ')? 31 : dayList(month,year);
								d.options.length = 0;
								d.options[d.options.length] = new Option('-- Ngày --',' ');
								for (var i = 1; i <= days; i++)
									d.options[d.options.length] = new Option(i,i);

							});


							function Change_info()
							{ 
								var hoten = document.getElementById('hoten').value;
								var name = document.getElementById('tendangnhap').value;
								var email = document.getElementById('email').value;
								var reg_mail = /^[A-Za-z0-9]+([_\.\-]?[A-Za-z0-9])*@[A-Za-z0-9]+([\.\-]?[A-Za-z0-9]+)*(\.[A-Za-z]+)+$/;

								if (hoten == ''){
									alert('Vui lòng nhập Họ và Tên');
								}
								else if(name.length < 2 || name.length > 30)
								{
									alert('Độ dài Họ và Tên từ 2 đến 30 kí tự');
								}
								else if (name == ''){
									alert('Vui lòng nhập Tên đăng nhập');
								}
								else if(name.length < 2 || name.length > 30)
								{
									alert('Độ dài Tên đăng nhập từ 2 đến 30 kí tự');
								}
								else if(email == ''){
									alert('Vui lòng nhập email');
								}
								else if(reg_mail.test(email) == false){
									alert('Email sai định dạng. Ex: example@abc.com');
								}
								else{
									if(confirm("Bạn thật sự muốn thay đổi thông tin?") == true){
										/*document.getElementById("name").innerHTML = hoten;
										document.getElementById("loginname").innerHTML = name;
										document.getElementById("email").innerHTML = email;*/
										alert("Thay đổi thành công!");
										return true;
									}
									else return false;
								}
								return false;
							}
						</script>
					</div>
				</form>
				<script type="text/javascript">
					function UpdateInfo(){
						$("#change-password").hide();
						$("#change-info").toggle();
						var y = document.getElementById('year');
						var m = document.getElementById('month');
						var seDay = $('#day');
						var year = y.options[y.selectedIndex].value;
						var month = m.options[m.selectedIndex+1].value;
						
						var days = (year == ' ' || month == ' ')? 31 : dayList(month,year);
						seDay.append('<option value="0">- Ngày -</option>');
						for (var i = 1; i <= days; i++) {
							if(i == datecur){
								seDay.append('<option value="'+i+'" selected>Ngày '+i+'</option>');
								continue;
							}
							seDay.append('<option value="'+i+'">Ngày '+i+'</option>');
						}
					}

					function UpdatePass(){
						$("#change-info").hide();
						$("#change-password").toggle();
					}
				</script>
				<?php
				}
				?>
			</div>
		</div>
	</div>

	<div class="feedback" id="feedback-box"><h4>Feedback</h4>		
		<a class="close" href="#">
			<img class="img-close" title="Close Window" alt="Close" src="image/close.png" width="25px" height="25px" />
		</a>
		<form class="feedback-content" action="#" method="post">
			<label class="username">
				<label for="username">Tên hoặc email</label>
				<input id="username" type="text" autocomplete="on" name="username" placeholder="" value="" />
			</label>
			<label class="contentname">
				<label for="contentid">Chủ đề</label>
				<input id="contentid" type="text" autocomplete="on" name="content" placeholder="" value="" />
			</label>
			<label class="content-form">
				<label for="contentdet">Nội dung</label>
				<textarea id="contentdet"></textarea>
			</label>
			<button class="button submit-button" type="button">Gửi</button>
		</form>
	</div>
	<?php
		include "include/feedback.html";
		include "include/footer.html";
	?>
</body>
</html>